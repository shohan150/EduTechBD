<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Class Routine</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        margin: 20px;
        background-color: #f9f9f9;
        color: #333;
      }

      #subjects {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .subject {
        width: 100px;
        padding: 10px;
        background-color: #007bff;
        border: 1px solid #0056b3;
        color: white;
        cursor: grab;
        text-align: center;
        border-radius: 5px;
        transition: transform 0.2s;
      }

      .subject:hover {
        transform: scale(1.1);
      }

      #form-container {
        margin-bottom: 20px;
      }

      #schedule-container {
        overflow-x: auto;
      }

      #schedule {
        display: grid;
        gap: 10px;
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        overflow-x: auto;
      }

      .header,
      .day-label {
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        background-color: #007bff;
        color: white;
        border: 1px solid #0056b3;
        border-radius: 5px;
        min-width: 100px;
      }

      .period {
        width: 100%;
        height: 100px;
        border: 1px solid #ccc;
        background-color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        border-radius: 5px;
        transition: background-color 0.2s, border-color 0.2s;
        min-width: 100px;
      }

      .period:hover {
        background-color: #f0f0f0;
        border-color: #007bff;
      }

      .period .delete {
        position: absolute;
        top: 5px;
        right: 5px;
        background-color: red;
        color: white;
        border: none;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        display: none;
        align-items: center;
        justify-content: center;
        cursor: pointer;
      }

      .period:hover .delete {
        display: flex;
      }

      .period.drag-over {
        border-color: #007bff;
        background-color: #e0e0e0;
      }

      #buttons {
        margin-top: 20px;
        display: flex;
        gap: 10px;
      }

      @media (max-width: 768px) {
        #schedule {
          grid-template-columns: 100px repeat(auto-fit, minmax(100px, 1fr));
        }

        .period,
        .header,
        .day-label {
          min-width: 100px;
        }
      }
    </style>
  </head>
  <body>
    <div id="form-container">
      <form id="period-form">
        <label for="num-periods">Number of periods per day:</label>
        <input
          type="number"
          id="num-periods"
          name="num-periods"
          min="1"
          max="10"
          required
        />
        <button type="submit">Save</button>
      </form>
    </div>

    <div id="subjects">
      <div class="subject" draggable="true">Math</div>
      <div class="subject" draggable="true">Science</div>
      <div class="subject" draggable="true">History</div>
      <div class="subject" draggable="true">Art</div>
      <div class="subject" draggable="true">PE</div>
      <div class="subject" draggable="true">Music</div>
      <div class="subject" draggable="true">Geography</div>
      <div class="subject" draggable="true">English</div>
    </div>

    <div id="schedule-container">
      <div id="schedule"></div>
    </div>

    <div id="buttons">
      <button id="save-button">Save</button>
      <button id="print-button">Print</button>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const subjects = document.querySelectorAll(".subject");
        const periodForm = document.getElementById("period-form");
        const scheduleContainer = document.getElementById("schedule");
        const saveButton = document.getElementById("save-button");
        const printButton = document.getElementById("print-button");

        periodForm.addEventListener("submit", (e) => {
          e.preventDefault();
          const numPeriods = document.getElementById("num-periods").value;
          createSchedule(numPeriods);
        });

        saveButton.addEventListener("click", saveRoutine);
        printButton.addEventListener("click", () => window.print());

        function createSchedule(numPeriods) {
          scheduleContainer.innerHTML = ""; // Clear existing schedule

          const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
          scheduleContainer.style.gridTemplateColumns = `100px repeat(${numPeriods}, 1fr)`;

          const headerRow = document.createElement("div");
          headerRow.classList.add("header");
          scheduleContainer.appendChild(headerRow); // Empty cell at the top-left

          for (let i = 1; i <= numPeriods; i++) {
            const header = document.createElement("div");
            header.classList.add("header");
            header.innerText = `${i} Period`;
            scheduleContainer.appendChild(header);
          }

          days.forEach((day) => {
            const dayLabel = document.createElement("div");
            dayLabel.classList.add("day-label");
            dayLabel.innerText = day;
            scheduleContainer.appendChild(dayLabel);

            for (let i = 1; i <= numPeriods; i++) {
              const period = document.createElement("div");
              period.classList.add("period");
              period.id = `${day.toLowerCase().slice(0, 3)}-p${i}`;
              const deleteButton = document.createElement("button");
              deleteButton.className = "delete";
              deleteButton.innerText = "x";
              deleteButton.addEventListener("click", deleteContent);
              period.appendChild(deleteButton);
              period.addEventListener("dragover", dragOver);
              period.addEventListener("dragleave", dragLeave);
              period.addEventListener("drop", drop);
              scheduleContainer.appendChild(period);
            }
          });
        }

        subjects.forEach((subject) => {
          subject.addEventListener("dragstart", dragStart);
        });

        function dragStart(e) {
          e.dataTransfer.setData("text/plain", e.target.innerText);
        }

        function dragOver(e) {
          e.preventDefault();
          e.currentTarget.classList.add("drag-over");
        }

        function dragLeave(e) {
          e.currentTarget.classList.remove("drag-over");
        }

        function drop(e) {
          e.preventDefault();
          e.currentTarget.classList.remove("drag-over");
          const text = e.dataTransfer.getData("text/plain");
          const clonedSubject = document.createElement("div");
          clonedSubject.className = "subject";
          clonedSubject.innerText = text;
          e.currentTarget.innerHTML = ""; // Clear existing content
          const deleteButton = document.createElement("button");
          deleteButton.className = "delete";
          deleteButton.innerText = "x";
          deleteButton.addEventListener("click", deleteContent);
          e.currentTarget.appendChild(clonedSubject);
          e.currentTarget.appendChild(deleteButton);
        }

        function deleteContent(e) {
          e.stopPropagation();
          const periodDiv = e.currentTarget.parentElement;
          periodDiv.innerHTML = '<button class="delete">x</button>';
          periodDiv
            .querySelector(".delete")
            .addEventListener("click", deleteContent);
        }
        function saveRoutine() {
          const routineData = {};
          const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
          days.forEach((day) => {
            routineData[day] = [];
            const dayPeriods = scheduleContainer.querySelectorAll(
              `.period[id^="${day.toLowerCase().slice(0, 3)}-p"]`
            );
            dayPeriods.forEach((period) => {
              const subject = period.querySelector(".subject")
                ? period.querySelector(".subject").innerText
                : null;
              routineData[day].push(subject);
            });
          });
          console.log(JSON.stringify(routineData, null, 2));
        }
      });
    </script>
  </body>
</html>
